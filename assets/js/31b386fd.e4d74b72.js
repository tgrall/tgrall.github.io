"use strict";(self.webpackChunktgrall_blog=self.webpackChunktgrall_blog||[]).push([[77984],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>m});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),c=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},p=function(e){var t=c(e.components);return n.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),h=c(a),m=r,d=h["".concat(s,".").concat(m)]||h[m]||u[m]||o;return a?n.createElement(d,i(i({ref:t},p),{},{components:a})):n.createElement(d,i({ref:t},p))}));function m(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,i=new Array(o);i[0]=h;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var c=2;c<o;c++)i[c]=a[c];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}h.displayName="MDXCreateElement"},96889:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>p});var n=a(87462),r=(a(67294),a(3905)),o=a(59943);const i={title:"Couchbase : Create a large dataset using Twitter and Java",tags:["couchbase","nosql","java","twitter"]},l=void 0,s={permalink:"/blog/2012/11/05/couchbase-create-a-large-dataset-using-twitter-and-java",editUrl:"https://github.dev/tgrall/tgrall.github.io/blob/main/blog/2012-11-05-couchbase-create-a-large-dataset-using-twitter-and-java.md",source:"@site/blog/2012-11-05-couchbase-create-a-large-dataset-using-twitter-and-java.md",title:"Couchbase : Create a large dataset using Twitter and Java",description:"An easy way to create large dataset when playing/demonstrating Couchbase -or any other NoSQL engine- is to inject Twitter feed into your database.",date:"2012-11-05T00:00:00.000Z",formattedDate:"November 5, 2012",tags:[{label:"couchbase",permalink:"/blog/tags/couchbase"},{label:"nosql",permalink:"/blog/tags/nosql"},{label:"java",permalink:"/blog/tags/java"},{label:"twitter",permalink:"/blog/tags/twitter"}],readingTime:3.025,hasTruncateMarker:!1,authors:[],frontMatter:{title:"Couchbase : Create a large dataset using Twitter and Java",tags:["couchbase","nosql","java","twitter"]},prevItem:{title:"New Adventure...",permalink:"/blog/2012/12/01/new-adventure-dot-dot-dot"},nextItem:{title:"Create a Simple Node.js and Couchbase application... on OS X",permalink:"/blog/2012/09/24/create-a-simple-node-dot-js-and-couchbase-application-dot-dot-dot-on-os-x"}},c={authorsImageUrls:[]},p=[{value:"Create oAuth Keys",id:"create-oauth-keys",level:4},{value:"Create the Java Application",id:"create-the-java-application",level:4},{value:"Packaging",id:"packaging",level:4},{value:"Run the Java Application",id:"run-the-java-application",level:4}],u={toc:p};function h(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"An easy way to create large dataset when playing/demonstrating Couchbase -or any other NoSQL engine- is to inject Twitter feed into your database."),(0,r.kt)("p",null,"For this small application I am using:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"http://www.couchbase.com/downloads-all#couchbase-server-2-0"},"Couchbase Server 2.0 Server")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"http://www.couchbase.com/develop/java/next"},"Couchbase Java SDK")," (will be installed by Maven)"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"http://twitter4j.org/"},"Twitter4J")," (will be installed by Maven)"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://dev.twitter.com/docs/streaming-apis"},"Twitter Streaming API")," called using Twitter4J")),(0,r.kt)("p",null,"In this example I am using Java to inject Tweets into Couchbase, you can obviously use another langage if you want to."),(0,r.kt)("p",null,"The sources of this project are available on my Github repository ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/tgrall/couchbase-twitter-injector"}," Twitter Injector for Couchbase")," you can also download the Binary version ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/downloads/tgrall/couchbase-twitter-injector/CouchbaseTwitterInjector.jar"},"here"),", and execute the application from the command line, see ",(0,r.kt)("a",{parentName:"p",href:"http://www.blogger.com/blogger.g?blogID=785895453418216075#runTheApp"},"Run The Application paragraph"),". Do not forget to create your Twitter oAuth keys (see next paragraph)"),(0,r.kt)("h4",{id:"create-oauth-keys"},"Create oAuth Keys"),(0,r.kt)("p",null,"The first thing to do to be able to use the Twitter API is to create a set of keys. If you want to learn more about all these keys/tokens take a look to the oAuth protocol : ",(0,r.kt)("a",{parentName:"p",href:"http://oauth.net/"},"http://oauth.net/")),(0,r.kt)("p",null,"1- Log in into the Twitter Development Portal : ",(0,r.kt)("a",{parentName:"p",href:"https://dev.twitter.com/"},"https://dev.twitter.com/")),(0,r.kt)("p",null,"2- Create a new Application"),(0,r.kt)("p",null,'Click on the "Create an App" link or go into the "User Menu ',">"," My Applications ",">",' Create a new application"'),(0,r.kt)("p",null,"3- Enter the Application Details information"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"http://4.bp.blogspot.com/-zxOaF_YLaO0/UJhoZOhjoJI/AAAAAAAAAVk/7HnRfFRSKxs/s320/couchbase-twitter-001.png",alt:null})),(0,r.kt)("p",null,'4- Click "Create Your Twitter Application" button'),(0,r.kt)("p",null,"Your application's OAuth settings are now available :"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"http://3.bp.blogspot.com/-ZdaST7c-HdY/UJhqi8WJMGI/AAAAAAAAAVs/ndeXQwc4F0k/s320/couchbase-twitter-002.png",alt:null})),(0,r.kt)("p",null,'5- Go down on the Application Settings page and click on the "Create My Access Token" button'),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"http://4.bp.blogspot.com/-WIW2AN93n6k/UJhrfZV1AVI/AAAAAAAAAV0/OseQ1EOpg9k/s320/couchbase-twitter-003.png",alt:null})),(0,r.kt)("p",null,"You have now all the necessary information to create your application:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Consumer key"),(0,r.kt)("li",{parentName:"ul"},"Consumer secret"),(0,r.kt)("li",{parentName:"ul"},"Access token"),(0,r.kt)("li",{parentName:"ul"},"Access token secret")),(0,r.kt)("p",null,"These keys will be uses in the ",(0,r.kt)("inlineCode",{parentName:"p"},"twitter4j.properties")," file when running the Java application from the command line"),(0,r.kt)("h4",{id:"create-the-java-application"},"Create the Java Application"),(0,r.kt)("p",null,"The following code is the main code of the application:"),(0,r.kt)(o.Z,{id:"4022377",mdxType:"Gist"}),(0,r.kt)("p",null,"Some basic explanation:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"The ",(0,r.kt)("inlineCode",{parentName:"li"},"setUp()")," method simply reads the ",(0,r.kt)("inlineCode",{parentName:"li"},"twitter4j.properties")," file from the classpath to build the Couchbase connection string."),(0,r.kt)("li",{parentName:"ul"},"The ",(0,r.kt)("inlineCode",{parentName:"li"},"injectTweets")," opens the Couchbase connection -line 76- and calls the TwitterStream API."),(0,r.kt)("li",{parentName:"ul"},"A Listener is created and will receive all the ",(0,r.kt)("inlineCode",{parentName:"li"},"onStatus(Status status)")," from Twitter. The most important method is onStatus() that receive the message and save it into Couchbase."),(0,r.kt)("li",{parentName:"ul"},"One interesting thing : since Couchbase is a JSON Document database it allows your to just take the JSON String and save it directly. ",(0,r.kt)("inlineCode",{parentName:"li"},"cbClient.add(idStr,0 ,twitterMessage);"))),(0,r.kt)("h4",{id:"packaging"},"Packaging"),(0,r.kt)("p",null,"To be able to execute the application directly from the Jar file, I am using the assembly plugin with the following informations from the pom.xml:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},"  ...\n<archive>\n<manifest>\n<mainclass>com.couchbase.demo.TwitterInjector</mainclass>\n</manifest>\n<manifestentries>\n<class-path>.</class-path>\n</manifestentries>\n</archive>\n...\n")),(0,r.kt)("p",null,"Some information:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"The mainClass entry allows you to set which class to execute when running java -jar command."),(0,r.kt)("li",{parentName:"ul"},"The Class-Path entry allows you to set the current directory as part of the classpath where the program will search for the twitter4j.properties file."),(0,r.kt)("li",{parentName:"ul"},"The assembly file is also configure to include all the dependencies (Twitter4J, Couchbase client  SDK, ...)")),(0,r.kt)("p",null,"If you do want to build it from the sources, simply run :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"mvn clean package\n")),(0,r.kt)("p",null,"This will create the following Jar file ./target/CouchbaseTwitterInjector.jar"),(0,r.kt)("h4",{id:"run-the-java-application"},"Run the Java Application"),(0,r.kt)("p",null,"Before running the application you must create a twitter4j.properties file with the following information :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"twitter4j.jsonStoreEnabled=true\n\noauth.consumerKey=[YOUR CONSUMER KEY]\noauth.consumerSecret=[YOUR CONSUMER SECRET KEY]\noauth.accessToken=[YOUR ACCESS TOKEN]\noauth.accessTokenSecret=[YOUR ACCESS TOKEN SECRET]\n\ncouchbase.uri.list=http://127.0.0.1:8091/pools\ncouchbase.bucket=default\ncouchbase.password=\n")),(0,r.kt)("p",null,"Save the properties file and from the same location run:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"jar -jar [path-to-jar]/CouchbaseTwitterInjector.jar\n")),(0,r.kt)("p",null,"This will inject Tweets into your Couchbase Server. Enjoy !"))}h.isMDXComponent=!0},59943:(e,t,a)=>{a.d(t,{Z:()=>o});var n=a(67294);function r(e,t){return r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},r(e,t)}const o=function(e){var t,a;function o(){return e.apply(this,arguments)||this}a=e,(t=o).prototype=Object.create(a.prototype),t.prototype.constructor=t,r(t,a);var i=o.prototype;return i.componentDidMount=function(){this._updateIframeContent()},i.componentDidUpdate=function(e,t){this._updateIframeContent()},i._defineUrl=function(){var e=this.props,t=e.id,a=e.file;return"https://gist.github.com/"+t+".js"+(a?"?file="+a:"")},i._updateIframeContent=function(){var e=this.props,t=e.id,a=e.file,n=this.iframeNode,r=n.document;n.contentDocument?r=n.contentDocument:n.contentWindow&&(r=n.contentWindow.document);var o='<html><head><base target="_parent"><style>*{font-size:12px;}</style></head><body '+("onload=\"parent.document.getElementById('"+(a?"gist-"+t+"-"+a:"gist-"+t)+"').style.height=document.body.scrollHeight + 'px'\"")+">"+('<script type="text/javascript" src="'+this._defineUrl()+'"><\/script>')+"</body></html>";r.open(),r.writeln(o),r.close()},i.render=function(){var e=this,t=this.props,a=t.id,r=t.file;return n.createElement("iframe",{ref:function(t){e.iframeNode=t},width:"100%",frameBorder:0,id:r?"gist-"+a+"-"+r:"gist-"+a})},o}(n.PureComponent)}}]);