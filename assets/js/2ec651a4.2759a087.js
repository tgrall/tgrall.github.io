(self.webpackChunktgrall_blog=self.webpackChunktgrall_blog||[]).push([[89172],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return p},kt:function(){return d}});var a=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=a.createContext({}),u=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},p=function(e){var t=u(e.components);return a.createElement(l.Provider,{value:t},e.children)},h={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,s=e.originalType,l=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),c=u(n),d=o,m=c["".concat(l,".").concat(d)]||c[d]||h[d]||s;return n?a.createElement(m,r(r({ref:t},p),{},{components:n})):a.createElement(m,r({ref:t},p))}));function d(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var s=n.length,r=new Array(s);r[0]=c;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i.mdxType="string"==typeof e?e:o,r[1]=i;for(var u=2;u<s;u++)r[u]=n[u];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},17581:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return i},contentTitle:function(){return l},metadata:function(){return u},assets:function(){return p},toc:function(){return h},default:function(){return d}});var a=n(22122),o=n(19756),s=(n(67294),n(3905)),r=["components"],i={title:"Web UI: What's behind AJAX? Simple use cases using XMLHttpRequest",tags:["ajax"]},l=void 0,u={permalink:"/blog/2005/05/09/web-ui-whats-behind-ajax-simple-use-cases-using-xmlhttprequest",editUrl:"https://github.dev/tgrall/tgrall.github.io/blob/main/blog/2005-05-09-web-ui-whats-behind-ajax-simple-use-cases-using-xmlhttprequest.md",source:"@site/blog/2005-05-09-web-ui-whats-behind-ajax-simple-use-cases-using-xmlhttprequest.md",title:"Web UI: What's behind AJAX? Simple use cases using XMLHttpRequest",description:'I am sure you already heard about AJAX, the "new" way of building Web',date:"2005-05-09T00:00:00.000Z",formattedDate:"May 9, 2005",tags:[{label:"ajax",permalink:"/blog/tags/ajax"}],readingTime:8.68,truncated:!0,authors:[],prevItem:{title:"Oracle SQL Developer Express",permalink:"/blog/2005/05/12/oracle-sql-developer-express"},nextItem:{title:"Which kind of developer are you? A software terrorist?",permalink:"/blog/2005/05/03/which-kind-of-developer-are-you-a-software-terrorist"}},p={authorsImageUrls:[]},h=[{value:"What do you need to know?",id:"what-do-you-need-to-know",children:[]},{value:"Usecase 1: Loading Message",id:"usecase-1-loading-message",children:[]},{value:"Usecase 2: Dependent Lists",id:"usecase-2-dependent-lists",children:[]},{value:"Summary",id:"summary",children:[]}],c={toc:h};function d(e){var t=e.components,n=(0,o.Z)(e,r);return(0,s.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("p",null,'I am sure you already heard about AJAX, the "new" way of building Web\napplication where using HTML, Javascript, DOM, and XML you can\n',"\xa0","build very interactive Web applications, some examples of\nthis interactivity are Google (suggest, local, mail), MSN, Amazon, ....."),(0,s.kt)("p",null,"If the term ","\xa0","Ajax is\nrelatively new, the technologies used are quite old now. And you do not\nneed anything new to be able to leverage this approach in your current\ndevelopment, and since it is mainly a client (browser) based technology\nthis can be used whether you develop your application in Java, PHP, or\nor even PL/SQL for the Web. In the same time, you do not want to have\nto develop too much of the client side to handle user interaction, this\nis where new frameworks that provide support of this technologies,\nlet's say AJAX based, are very interesting. It is now possible to\ncreate very interactive Web application without passing 80% of your\ntime in the client side development - that could be generated from your\nserver obviously."),(0,s.kt)("p",null,"In the same time, before adopting such framework, it is important to\nunderstand what is happening. This is why I am creating this quick\nintroduction based on 2 simple use cases:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"http://www.grallandco.com/blog/archives/ajax/demo-2.html"},"loading message"),":\n","\xa0","you often want to provide some\nfeedback to your user when your browser is processing some data"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"http://www.grallandco.com/blog/archives/ajax/demo-3.html"},"dependent lists"),":\nhow you can easily create dependent lists, in lot of application you\nwant to drive a selection list from another")),(0,s.kt)("p",null,"Update May 30:"),(0,s.kt)("p",null,"If you have tested my sample on Safari, you can see that the first request works, but following subsequent requests do not, on work around is to modify the HTTP header adding the following value, has to be done before the send, just send a old date..."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-javascript"},"httpRequest.setRequestHeader('If-Modified-Since','Sun,3 Jun 1973 00:00:00 GMT');\n")),(0,s.kt)("h3",{id:"what-do-you-need-to-know"},"What do you need to know?"),(0,s.kt)("p",null,"The first interesting part is the object XMLHttpRequest. This object is\ncurrently supported by most of the browsers. As usual with HTML and\nJavascript the cross browser/platform testing is one of the most\nimportant part of your project. XMLHttpRequest is not new since\nMicrosoft has implemented it in Internet Explorer 5 as an ActiveX\nobject. Also it has been later on integrate as a native component into\nMozzila and Netscape (7.0), and into Apple Safari. If originally this\nobject as been created to load data, as XML in the\nbackground, you can using it to load any data."),(0,s.kt)("h4",{id:"creating-xmlhttprequest-object"},"Creating XMLHttpRequest Object"),(0,s.kt)("p",null,"As usual with Javascript, it begins with interoperability issue ;-),\nsince in the MSFT world the XMLHttpRequest is implemented as an ActiveX\nand in the other world(s) it is an native object, you have different\nways to create the object. The idea is too test if the current browser\nsupports or not the object and depending of the result create the\nobject."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-javascript"},'\nif (window.ActiveXObject)\n{\n  // Microsoft Way\n  httpRequest = new ActiveXObject("Microsoft.XMLHTTP");\n}\nelse if (window.XMLHttpRequest)\n{\n  // Others...\n  httpRequest = new XMLHttpRequest();\n}\n\n')),(0,s.kt)("p",null,"Note: another way of choosing which code path to use depending of the\nversion of the browser is to use ",(0,s.kt)("a",{parentName:"p",href:"http://msdn.microsoft.com/library/default.asp?url=/library/en-us/script56/html/js56jsconconditionalcompilation.asp"},"conditional compilation"),"\nfor the Javascript engine."),(0,s.kt)("p",null,"Also I would add that it is probably good to provide a degraded version\nof your application if you can not control which browser will be used\nby your client, or if you want to provide that to mobile people. This\nis for example what Google Mail is doing with its ",(0,s.kt)("a",{parentName:"p",href:"http://gmail.google.com/support/bin/answer.py?ctx=gmail&hl=en&answer=15049"},"Basic HTML"),"\nview."),(0,s.kt)("h4",{id:"retrieving-the-data"},"Retrieving the data"),(0,s.kt)("p",null,"asynchronously"),(0,s.kt)("p",null,"One of the most interesting features of the XMLHttpRequestObject is the\nfact that you get data from a URL in the background of the user\nactivity. This is how you can give lot of interactivity to your\napplications."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-javascript"},'httpRequest.open("GET", "./getEmployeeList?deptno=10", true);\nhttpRequest.onreadystatechange= function () {processRequest(); } ;\nhttpRequest.send(null);\n')),(0,s.kt)("p",null,"The ",(0,s.kt)("a",{parentName:"p",href:"http://msdn.microsoft.com/library/default.asp?url=/library/en-us/xmlsdk/html/xmmthopenixmlhttprequest.asp"},"open"),"\nmethod sets the different values that will be used by your request,\nsuch as the type of request, the URL, if it is synchronous or not."),(0,s.kt)("p",null,'The "magic" comes from the',"\xa0",(0,s.kt)("a",{parentName:"p",href:"http://msdn.microsoft.com/library/default.asp?url=/library/en-us/xmlsdk/html/xmproonreadystatechangehttprequest.asp"},"onreadystatechange"),"\xa0","property.\nThis propery set an handler that will be called when the property ",(0,s.kt)("a",{parentName:"p",href:"http://msdn.microsoft.com/library/default.asp?url=/library/en-us/xmlsdk/html/xmproreadystaterequest.asp"},"readyState"),"\nchanges, when the request is sent, loading, or completed... Meaning,\nthis is in this event handler, the processRequest\nmethod in the sample, that you test if the response has been completed\ncorrectly, and process the data."),(0,s.kt)("p",null,"Note: even if it is possible, I do not think that you should use the\nXMLHttpRequest in a synchronous mode since it will freeze the browser\nof the user, for the duration of the request."),(0,s.kt)("h4",{id:"processing-the-response"},"Processing the response"),(0,s.kt)("p",null,"As I said above the magic happens in the event handler associated with\nthe state of the request. Let's see how you manipulate the request and\nresponse:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-javascript"},'function processRequest()\n{\n  if (httpRequest.readyState == 4)\n  {\n    if(httpRequest.status == 200)\n    {\n      // process data as XML\n      httpRequest.responseXML;\n\n      // or Text\n      alert(httpRequest.responseText);\n    }\n    else\n    {\n      alert("Error loading page\\n"+ httpRequest.status +":"+ httpRequest.statusText);\n    }\n  }\n}\n\n')),(0,s.kt)("p",null,"The ",(0,s.kt)("a",{parentName:"p",href:"http://msdn.microsoft.com/library/default.asp?url=/library/en-us/xmlsdk/html/xmproreadystaterequest.asp"},"readyState"),"\npropery is used to know if all the data of the response have been\nreceived or not, the different value for the state are:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"0 : uninitialized"),(0,s.kt)("li",{parentName:"ul"},"1 : loading"),(0,s.kt)("li",{parentName:"ul"},"2 :loaded"),(0,s.kt)("li",{parentName:"ul"},"3 : interactive"),(0,s.kt)("li",{parentName:"ul"},"4 : completed\nMost of the time, you will just test the status 4. In my example I wait\nfor status==4 and then I check the status of the response. The ",(0,s.kt)("a",{parentName:"li",href:"http://msdn.microsoft.com/library/default.asp?url=/library/en-us/xmlsdk/html/xmprostatusixmlhttprequest.asp"},"status"),"\nis the status returned by the server, for example 200 for OK, 404 for\nnot found.")),(0,s.kt)("p",null,"Then you can treat the response as XML using the ",(0,s.kt)("a",{parentName:"p",href:"http://msdn.microsoft.com/library/default.asp?url=/library/en-us/xmlsdk/html/xmproresponsexmlixmlhttprequest.asp"},"responseXML"),",\nin this case you can manipulate the XML using the client DOM API. But\nyou can also directly take the content as a string using the ",(0,s.kt)("a",{parentName:"p",href:"http://msdn.microsoft.com/library/default.asp?url=/library/en-us/xmlsdk/html/xmproresponsetextixmlhttprequest.asp"},"responseText"),"\nproperty."),(0,s.kt)("h4",{id:"manipulating-the-data"},"Manipulating the Data"),(0,s.kt)("p",null,"You now have the data back from the request, as Text or XML, you just\nneed using Javascript manipulate them and copy then into some part of\nyour page. So all is based on the client side. Let's do a very simple\nexample before moving to the use cases:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"http://www.grallandco.com/blog/archives/demo-1.html"},"Simple XMLHttpRequest sample")," ",(0,s.kt)("em",{parentName:"li"},"What is happening?"))),(0,s.kt)("p",null,"Since I have explained the call above, here is the simple code that is\nused to copy the content from the XMLHttpRequest object to the page:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-javascript"},'.....\nif(httpRequest.status == 200)\n{\n  var contentViewer = document.getElementById("contentViewer");\n  contentViewer.innerHTML = httpRequest.responseText;\n}\n....\n')),(0,s.kt)("p",null,"Most of the time, if you do ","\xa0","not use XML you just have to copy\nthe content of the result into a section of your page, so to do it you\nuse:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"create a DIV tag in yourpage with a specific id. (or other...)"),(0,s.kt)("li",{parentName:"ul"},"get the object you want to copy into using the ",(0,s.kt)("inlineCode",{parentName:"li"},"document.getElementById()")," method, that is the most simple way...","\xa0"),(0,s.kt)("li",{parentName:"ul"},"then from the object just use the ",(0,s.kt)("inlineCode",{parentName:"li"},"innerHTML"),"\nproperty that represent the content of this DIV object. (You can also\nuse the DOM API, to do the same thing, I am sure puris will say that\nthis is the only way to do it correctly... )\nIn most of the frameworks the data are exchanged in XML and some\ngeneric methods are calls on the client side to propulate data in the\ndifferent components of the page.")),(0,s.kt)("h3",{id:"usecase-1-loading-message"},"Usecase 1: Loading Message"),(0,s.kt)("p",null,"One common use case is to be able to have some feedback during\nprocessing of a request. Using the same approach you can print a\nmessage until the response is completely done."),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"http://www.grallandco.com/blog/archives/ajax/demo-2.html"},"Online Demonstration")," ",(0,s.kt)("em",{parentName:"li"},"What is happening?"))),(0,s.kt)("p",null,'The tip here is just to take a zone where you want to print the status\n("Loading..." for example). When the XMLHttpRequest status is different\nthan 4 (completed) ',"\xa0","just print the status in this section\nusing for example the innerHTML property. When the request is\ncompleted, just move the content of this zone to blank, or in our case\nthe result of the request is printed into it."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-javascript"},'....\nif (httpRequest.readyState == 4)\n{\n  if(httpRequest.status == 200)\n  {\n    // print the content of the page\n    var contentViewer = document.getElementById("contentViewer");\n    contentViewer.innerHTML = httpRequest.responseText;\n  }\n}\nelse\n{\n  // Print the loading message....\n  var contentViewer = document.getElementById("contentViewer");\n  contentViewer.innerHTML = "<b style=\'color:red;\'>Loading....<b>";\n}\n...\n')),(0,s.kt)("h3",{id:"usecase-2-dependent-lists"},"Usecase 2: Dependent Lists"),(0,s.kt)("p",null,"In lot of applications, you have submission form when one drop down list is controlled by another one. You have several way to support that depending of the size of your data set. For example you can download\nall the records (master and detail) and use some client side\nprogramming to refresh the content of the detail list depending of the\nvalue selected in the master one; or ","\xa0","another solution is to\njust reload the page."),(0,s.kt)("p",null,"Using XMLHttpRequest, you can now just call the server to populate the\nvalues of the detail list when the user select another value in the\nmaster list. (and you can implement a client side cache if you want to\navoid a second call with the same parameters, but this is another\nstory...)"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"http://www.grallandco.com/blog/archives/ajax/demo-3.html"},"Online Demonstration")," ",(0,s.kt)("em",{parentName:"li"},"What is happening?"))),(0,s.kt)("p",null,"Nothing more complex than in the previous examples, on the ",(0,s.kt)("inlineCode",{parentName:"p"},"onChange"),"\nof the master list (dept in the example) , you call a Javascript method\nthat create the XMLHttRequest, with the correct parameter."),(0,s.kt)("p",null,"Then in the event handler of this request, you populate the data as XML\nand add them to the detail list (emp in the example)."),(0,s.kt)("p",null,"In this specific example I used XML, but if you want for simpler code\nyou can write all in HTML and use the innerHTML property, but this is\njust a choice of implementation isn't?"),(0,s.kt)("h3",{id:"summary"},"Summary"),(0,s.kt)("p",null,"First of all, you have seen that what we have behind AJAX is not just\nnew technologies. The technologies exists now for a while, they have\nbeen exposed to the masse by Google, MSN, and other Web sites. The term\nitself is definitevely a recent one..."),(0,s.kt)("p",null,"Also, I have showed you simple examples that can help you for your\ncurrent developments, but you need to write some code on the client.\nThe real future of AJAX, is when this is bundle into a framework, into\nthe Faces components your are using. So before starting to implement\nsuch code in your application you should take a look around to see if\nany solution exists that can answer your need..."),(0,s.kt)("p",null,"  You can download the source of the demonstrations ",(0,s.kt)("a",{parentName:"p",href:"http://www.grallandco.com/blog/archives/ajax/xmlhttprequest-demos.zip"},"here"),". I tried to keep the code as simple as possible by providing all the source in each single html file."))}d.isMDXComponent=!0}}]);