(self.webpackChunktgrall_blog=self.webpackChunktgrall_blog||[]).push([[77984],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return p},kt:function(){return m}});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),h=c(n),m=r,d=h["".concat(s,".").concat(m)]||h[m]||u[m]||o;return n?a.createElement(d,i(i({ref:t},p),{},{components:n})):a.createElement(d,i({ref:t},p))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=h;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var c=2;c<o;c++)i[c]=n[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},96889:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return c},metadata:function(){return p},assets:function(){return u},toc:function(){return h},default:function(){return d}});var a=n(22122),r=n(19756),o=(n(67294),n(3905)),i=n(59943),l=["components"],s={title:"Couchbase : Create a large dataset using Twitter and Java",tags:["couchbase","nosql","java","twitter"]},c=void 0,p={permalink:"/blog/2012/11/05/couchbase-create-a-large-dataset-using-twitter-and-java",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/blog/blog/2012-11-05-couchbase-create-a-large-dataset-using-twitter-and-java.md",source:"@site/blog/2012-11-05-couchbase-create-a-large-dataset-using-twitter-and-java.md",title:"Couchbase : Create a large dataset using Twitter and Java",description:"An easy way to create large dataset when playing/demonstrating Couchbase -or any other NoSQL engine- is to inject Twitter feed into your database.",date:"2012-11-05T00:00:00.000Z",formattedDate:"November 5, 2012",tags:[{label:"couchbase",permalink:"/blog/tags/couchbase"},{label:"nosql",permalink:"/blog/tags/nosql"},{label:"java",permalink:"/blog/tags/java"},{label:"twitter",permalink:"/blog/tags/twitter"}],readingTime:3.025,truncated:!1,authors:[],prevItem:{title:"New Adventure...",permalink:"/blog/2012/12/01/new-adventure-dot-dot-dot"},nextItem:{title:"Create a Simple Node.js and Couchbase application... on OS X",permalink:"/blog/2012/09/24/create-a-simple-node-dot-js-and-couchbase-application-dot-dot-dot-on-os-x"}},u={authorsImageUrls:[]},h=[],m={toc:h};function d(e){var t=e.components,n=(0,r.Z)(e,l);return(0,o.kt)("wrapper",(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"An easy way to create large dataset when playing/demonstrating Couchbase -or any other NoSQL engine- is to inject Twitter feed into your database."),(0,o.kt)("p",null,"For this small application I am using:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"http://www.couchbase.com/downloads-all#couchbase-server-2-0"},"Couchbase Server 2.0 Server")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"http://www.couchbase.com/develop/java/next"},"Couchbase Java SDK")," (will be installed by Maven)"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"http://twitter4j.org/"},"Twitter4J")," (will be installed by Maven)"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://dev.twitter.com/docs/streaming-apis"},"Twitter Streaming API")," called using Twitter4J")),(0,o.kt)("p",null,"In this example I am using Java to inject Tweets into Couchbase, you can obviously use another langage if you want to."),(0,o.kt)("p",null,"The sources of this project are available on my Github repository ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/tgrall/couchbase-twitter-injector"}," Twitter Injector for Couchbase")," you can also download the Binary version ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/downloads/tgrall/couchbase-twitter-injector/CouchbaseTwitterInjector.jar"},"here"),", and execute the application from the command line, see ",(0,o.kt)("a",{parentName:"p",href:"http://www.blogger.com/blogger.g?blogID=785895453418216075#runTheApp"},"Run The Application paragraph"),". Do not forget to create your Twitter oAuth keys (see next paragraph)"),(0,o.kt)("h4",{id:"create-oauth-keys"},"Create oAuth Keys"),(0,o.kt)("p",null,"The first thing to do to be able to use the Twitter API is to create a set of keys. If you want to learn more about all these keys/tokens take a look to the oAuth protocol : ",(0,o.kt)("a",{parentName:"p",href:"http://oauth.net/"},"http://oauth.net/")),(0,o.kt)("p",null,"1- Log in into the Twitter Development Portal : ",(0,o.kt)("a",{parentName:"p",href:"https://dev.twitter.com/"},"https://dev.twitter.com/")),(0,o.kt)("p",null,"2- Create a new Application"),(0,o.kt)("p",null,'Click on the "Create an App" link or go into the "User Menu ',">"," My Applications ",">",' Create a new application"'),(0,o.kt)("p",null,"3- Enter the Application Details information"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"http://4.bp.blogspot.com/-zxOaF_YLaO0/UJhoZOhjoJI/AAAAAAAAAVk/7HnRfFRSKxs/s320/couchbase-twitter-001.png",alt:null})),(0,o.kt)("p",null,'4- Click "Create Your Twitter Application" button'),(0,o.kt)("p",null,"Your application's OAuth settings are now available :"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"http://3.bp.blogspot.com/-ZdaST7c-HdY/UJhqi8WJMGI/AAAAAAAAAVs/ndeXQwc4F0k/s320/couchbase-twitter-002.png",alt:null})),(0,o.kt)("p",null,'5- Go down on the Application Settings page and click on the "Create My Access Token" button'),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"http://4.bp.blogspot.com/-WIW2AN93n6k/UJhrfZV1AVI/AAAAAAAAAV0/OseQ1EOpg9k/s320/couchbase-twitter-003.png",alt:null})),(0,o.kt)("p",null,"You have now all the necessary information to create your application:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Consumer key"),(0,o.kt)("li",{parentName:"ul"},"Consumer secret"),(0,o.kt)("li",{parentName:"ul"},"Access token"),(0,o.kt)("li",{parentName:"ul"},"Access token secret")),(0,o.kt)("p",null,"These keys will be uses in the ",(0,o.kt)("inlineCode",{parentName:"p"},"twitter4j.properties")," file when running the Java application from the command line"),(0,o.kt)("h4",{id:"create-the-java-application"},"Create the Java Application"),(0,o.kt)("p",null,"The following code is the main code of the application:"),(0,o.kt)(i.Z,{id:"4022377",mdxType:"Gist"}),(0,o.kt)("p",null,"Some basic explanation:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"The ",(0,o.kt)("inlineCode",{parentName:"li"},"setUp()")," method simply reads the ",(0,o.kt)("inlineCode",{parentName:"li"},"twitter4j.properties")," file from the classpath to build the Couchbase connection string."),(0,o.kt)("li",{parentName:"ul"},"The ",(0,o.kt)("inlineCode",{parentName:"li"},"injectTweets")," opens the Couchbase connection -line 76- and calls the TwitterStream API."),(0,o.kt)("li",{parentName:"ul"},"A Listener is created and will receive all the ",(0,o.kt)("inlineCode",{parentName:"li"},"onStatus(Status status)")," from Twitter. The most important method is onStatus() that receive the message and save it into Couchbase."),(0,o.kt)("li",{parentName:"ul"},"One interesting thing : since Couchbase is a JSON Document database it allows your to just take the JSON String and save it directly. ",(0,o.kt)("inlineCode",{parentName:"li"},"cbClient.add(idStr,0 ,twitterMessage);"))),(0,o.kt)("h4",{id:"packaging"},"Packaging"),(0,o.kt)("p",null,"To be able to execute the application directly from the Jar file, I am using the assembly plugin with the following informations from the pom.xml:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},"  ...\n<archive>\n<manifest>\n<mainclass>com.couchbase.demo.TwitterInjector</mainclass>\n</manifest>\n<manifestentries>\n<class-path>.</class-path>\n</manifestentries>\n</archive>\n...\n")),(0,o.kt)("p",null,"Some information:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"The mainClass entry allows you to set which class to execute when running java -jar command."),(0,o.kt)("li",{parentName:"ul"},"The Class-Path entry allows you to set the current directory as part of the classpath where the program will search for the twitter4j.properties file."),(0,o.kt)("li",{parentName:"ul"},"The assembly file is also configure to include all the dependencies (Twitter4J, Couchbase client  SDK, ...)")),(0,o.kt)("p",null,"If you do want to build it from the sources, simply run :"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"mvn clean package\n")),(0,o.kt)("p",null,"This will create the following Jar file ./target/CouchbaseTwitterInjector.jar"),(0,o.kt)("h4",{id:"run-the-java-application"},"Run the Java Application"),(0,o.kt)("p",null,"Before running the application you must create a twitter4j.properties file with the following information :"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"twitter4j.jsonStoreEnabled=true\n\noauth.consumerKey=[YOUR CONSUMER KEY]\noauth.consumerSecret=[YOUR CONSUMER SECRET KEY]\noauth.accessToken=[YOUR ACCESS TOKEN]\noauth.accessTokenSecret=[YOUR ACCESS TOKEN SECRET]\n\ncouchbase.uri.list=http://127.0.0.1:8091/pools\ncouchbase.bucket=default\ncouchbase.password=\n")),(0,o.kt)("p",null,"Save the properties file and from the same location run:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"jar -jar [path-to-jar]/CouchbaseTwitterInjector.jar\n")),(0,o.kt)("p",null,"This will inject Tweets into your Couchbase Server. Enjoy !"))}d.isMDXComponent=!0},59943:function(e,t,n){"use strict";var a=n(67294);n(45697);function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var i=function(e){function t(){return r(this,t),o(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentDidMount=function(){this._updateIframeContent()},t.prototype.componentDidUpdate=function(e,t){this._updateIframeContent()},t.prototype._defineUrl=function(){var e=this.props,t=e.id,n=e.file;return"https://gist.github.com/"+t+".js"+(n?"?file="+n:"")},t.prototype._updateIframeContent=function(){var e=this.props,t=e.id,n=e.file,a=this.iframeNode,r=a.document;a.contentDocument?r=a.contentDocument:a.contentWindow&&(r=a.contentWindow.document);var o='<html><head><base target="_parent"><style>*{font-size:12px;}</style></head><body '+("onload=\"parent.document.getElementById('"+(n?"gist-"+t+"-"+n:"gist-"+t)+"').style.height=document.body.scrollHeight + 'px'\"")+">"+('<script type="text/javascript" src="'+this._defineUrl()+'"><\/script>')+"</body></html>";r.open(),r.writeln(o),r.close()},t.prototype.render=function(){var e=this,t=this.props,n=t.id,r=t.file;return a.createElement("iframe",{ref:function(t){e.iframeNode=t},width:"100%",frameBorder:0,id:r?"gist-"+n+"-"+r:"gist-"+n})},t}(a.PureComponent);t.Z=i}}]);