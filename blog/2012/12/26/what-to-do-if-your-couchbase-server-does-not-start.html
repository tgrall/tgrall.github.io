<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Tug&#39;s Site Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Tug&#39;s Site Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-1520374-2","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script><title data-react-helmet="true">What to do if your Couchbase Server does not start? | Tug&#x27;s Site</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://tgrall.github.io/blog/2012/12/26/what-to-do-if-your-couchbase-server-does-not-start"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><meta data-react-helmet="true" property="og:title" content="What to do if your Couchbase Server does not start? | Tug&#x27;s Site"><meta data-react-helmet="true" name="description" content="Working with the Couchbase 2.0.0 release you may have issues when trying to access the Web Admin Console or simply starting the server. This is due to the way Couchbase Server uses the IP address/hostname during the installation process. So when you have one of the following errors :"><meta data-react-helmet="true" property="og:description" content="Working with the Couchbase 2.0.0 release you may have issues when trying to access the Web Admin Console or simply starting the server. This is due to the way Couchbase Server uses the IP address/hostname during the installation process. So when you have one of the following errors :"><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2012-12-26T00:00:00.000Z"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://tgrall.github.io/blog/2012/12/26/what-to-do-if-your-couchbase-server-does-not-start"><link data-react-helmet="true" rel="alternate" href="https://tgrall.github.io/blog/2012/12/26/what-to-do-if-your-couchbase-server-does-not-start" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://tgrall.github.io/blog/2012/12/26/what-to-do-if-your-couchbase-server-does-not-start" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.acbe81c6.css">
<link rel="preload" href="/assets/js/runtime~main.92eea956.js" as="script">
<link rel="preload" href="/assets/js/main.d815768e.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.png" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Tug&#x27;s Site</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/talks">Talks</a></div><div class="navbar__items navbar__items--right"><a href="https://windr.org" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Windsurfing App<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://github.com/tgrall/tgrall.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">üåú</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">üåû</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_2ahu thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_2hhb margin-bottom--md">Recent posts</div><ul class="sidebarItemList_2xAf"><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/11/07/how-to-write-a-github-action-annotation-api">Write GitHub Action: Checks and Annotations API (Part 2)</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/10/30/how-to-write-a-github-action">How to Write Custom GitHub Action (Part 1)</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2020/05/16/simple-caching-service-with-redis">Simple caching service with Redis</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2020/01/02/how-to-use-ssl-slash-tls-with-redis-enterprise">How to use SSL/TLS with Redis Enterprise</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2019/09/19/redis-rolling-upgrade-on-pivotal-cloud-foundry-pcf">Redis Rolling Upgrade on Pivotal Cloud Foundry (PCF)</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_GeHD" itemprop="headline">What to do if your Couchbase Server does not start?</h1><div class="blogPostData_291c margin-vert--md"><time datetime="2012-12-26T00:00:00.000Z" itemprop="datePublished">December 26, 2012</time> ¬∑ 6 min read</div></header><div class="markdown" itemprop="articleBody"><p>Working with the Couchbase 2.0.0 release you may have issues when trying to access the Web Admin Console or simply starting the server. This is due to the way Couchbase Server uses the IP address/hostname during the installation process. So when you have one of the following errors :</p><ul><li>On Windows, Server is not working at all, even after installation. You can access the sever on port 8092 (Couchbase API port), but cannot on port 8091</li><li>You have the following error when accessing the console <code>&quot;[10:02:02] IP address seems to have changed. Unable to listen on &#x27;ns_1@10.0.2.15&#x27;&quot;</code></li></ul><p><img src="http://2.bp.blogspot.com/-OXj1bGEZTGg/UNs8QBx6X-I/AAAAAAAAAaI/TproFMOQXcE/s320/cb-20-ip-address-error.png"></p><ul><li>When you try to restart the server it does not start and you have the following error message in the error log :
<code>&quot;Configured address &#x27;10.0.2.15&#x27; seems to be invalid. Will refuse to start for safety reasons&quot;</code></li></ul><p>Some of these issues are related to a known issue on Windows ( see <a href="http://www.couchbase.com/issues/browse/MB-7417" target="_blank" rel="noopener noreferrer">MB-7417</a> that will be fixed in 2.0.1) or the fact that Couchbase server does not support change of the IP address after installation.  This is documented in the section ‚Äú<a href="http://www.couchbase.com/docs/couchbase-manual-2.0/couchbase-bestpractice-cloud-ip.html" target="_blank" rel="noopener noreferrer">Using Couchbase in the Cloud: Handling Changes in IP Addresses</a>‚Äù of the Couchbase Server Manual. This article explains what should be done when configuring Couchbase Server on Windows, but you can do equivalent steps on any platform using the shell scripts available on Linux and/or Mac OS X.</p><p>Once you have installed Couchbase, you can see in the console that the IP address of your server is used :
<img src="http://3.bp.blogspot.com/-7wJEnnsZNlA/ULzAYBU09tI/AAAAAAAAAZk/PxZGdUbqo6k/s320/Screen+Shot+2012-12-03+at+4.07.03+PM.png"></p><p>Typically the address 192.168.0.97 is stored in the configuration of Couchbase. If your server receives a new address from the DHCP server, Couchbase will not work anymore. In this article you will see how you can configure Couchbase to use another IP address or Hostname.</p><p><strong>Important:</strong> The steps that follow will completely destroy any data and configuration from the node, so it is best to start with a fresh Couchbase install. If you can not, you should backup your data using the file based backup-restore documented <a href="http://www.couchbase.com/docs/couchbase-manual-2.0/couchbase-backup-restore.html" target="_blank" rel="noopener noreferrer">here</a>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="setting-up-a-hostname-in-hosts-file"></a>Setting up a hostname in hosts file<a class="hash-link" href="#setting-up-a-hostname-in-hosts-file" title="Direct link to heading">#</a></h3><p>The best practice is to register Couchbase using a hostname instead of an IP Address. For this you will need to associate this hostname to an IP address in the <code>hosts</code> file.</p><p>Since the <code>hosts</code> file is part of the system, <em>you need to edit it as administrator</em>. You have different approaches to achieve this:</p><p>The following steps explain the easiest way to do it:  </p><ol><li>Click ‚ÄúStart Menu‚Äù</li><li>Navigate to ‚ÄúAll Programs &gt; Accessories‚Äù</li><li>‚ÄúRight Click‚Äù on ‚ÄúNotepad‚Äù (or your favorite text editor)</li><li>Click ‚ÄúRun as Administrator‚Äù</li></ol><p><img src="http://4.bp.blogspot.com/-gxd-rAWLqd8/ULy-vIxak3I/AAAAAAAAAZc/00pNi3Iu0uc/s320/Screen+Shot+2012-12-03+at+3.57.16+PM.png"></p><p>You can now open the file <code>C:\Windows\System21\drivers\etc\hosts</code></p><p>Add a new entry with a host name that will be used by Couchbase Server for example something like :</p><p><code>127.0.0.1    couchbase-node1.mycompany.com</code></p><p>Here I am using the local address (127.0.0.1) like that I won&#x27;t have to change it even when my IP address changes. (This is useful when you are working in a single node mode)</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="configure-couchbase-to-use-the-hostname-or-new-ip-address"></a>Configure Couchbase to use the hostname or new IP address<a class="hash-link" href="#configure-couchbase-to-use-the-hostname-or-new-ip-address" title="Direct link to heading">#</a></h3><p>During the installation Couchbase has been registered as a Windows Service. To be able to associate Couchbase to the new hostname (or IP address) the service needs to re-configured and reinstalled.</p><p>This could be done using the scripts provided with the product. To run the scripts you need to do it as administrators, you can do it with one of the following methods:</p><ul><li>Search for the file and right click and select <code>Run as Administrator</code> (documented below)</li><li>Run the terminal as administrator and run all the command from there (documented below)</li><li>Search for the file and run it using <code>Ctrl+Shift+Enter</code></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="option-1--using-the-start-menu-and-search-program"></a>Option 1 : Using the Start Menu and Search Program<a class="hash-link" href="#option-1--using-the-start-menu-and-search-program" title="Direct link to heading">#</a></h4><p><strong>Stop Couchbase Server Windows Service</strong></p><p>The first thing to do, is to stop this service that is automatically started after the installation:</p><ol><li>Click <code>Start Menu</code></li><li>Type <code>Services</code> in the Search Program form</li><li>Click on <code>Services</code></li><li>In the Services Application navigate to <code>CouchbaseServer</code></li><li>Right Click and Click on <code>Stop</code></li><li>Couchbase is now stopped.</li></ol><p><strong>Edit the Service Register script</strong></p><p>Note: Due to a small formatting issue (See <a href="http://www.couchbase.com/issues/browse/MB-7322" target="_blank" rel="noopener noreferrer">MB-7322</a>), Notepad could not be used, a solution is to take <a href="http://notepad-plus-plus.org/" target="_blank" rel="noopener noreferrer">Notepad++</a> or any other advanced editing tool.</p><ol><li>As Administrator, open the <code>C:\Program Files\Couchbase\Server\bin\service_register.bat</code> file with your favorite editor. To open the editor as Administrator you can use the approach described in the previous step.</li><li>Edit the line 9 to replace <code>%IP_ADDR%</code> by your hostname, the line should look like: <code>NS_NAME=ns_1@couchbase-node1.mycompany.com</code></li><li>Save the file</li></ol><p><strong>Delete existing configuration and logs</strong></p><ol><li>Using the file explorer, go into: <code>C:\Program Files\Couchbase\Server\var\lib\couchbase\mnesia</code></li><li>Delete its content (Select All and Right Click)</li></ol><p><strong>Register the new Configuration as Service</strong></p><ol><li>Using the file explorer, go into: <code>C:\Program Files\Couchbase\Server\bin</code></li><li>Right Click on <code>service_reregister.bat</code></li><li>Click on <code>Run as Administrator</code></li></ol><p>This script recreates the Couchbase Server Windows Service and starts it automatically.</p><p><strong>Check the configuration</strong></p><ol><li>Launch your Internet Browser</li><li>Go to http://localhost:8091</li><li>Follow the Couchbase Installation Steps</li><li>Once install connect to the console</li><li>Go to <code>Server Nodes</code> tab</li><li>Check that the server name is now <code>couchbase-node1.mycompany.com</code></li></ol><p><img src="http://3.bp.blogspot.com/-tAn4jv_cdrk/ULzOA53roDI/AAAAAAAAAZ0/r8gts5uSdbU/s320/Screen+Shot+2012-12-03+at+5.06.07+PM.png"></p><p>Your Couchbase node is now configured to use the hostname of your server.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="option-2--using-the-command-line"></a>Option 2 : Using the Command Line<a class="hash-link" href="#option-2--using-the-command-line" title="Direct link to heading">#</a></h4><p><strong>Launch Command Prompt as Administrator</strong></p><ol><li>Click <code>Start Menu</code></li><li>Type <code>Command Prompt</code> in the Search program form</li><li>Type <code>Ctrl+Shift+Enter</code></li><li>Go to <code>C:\Program Files\Couchbase\Server\bin</code> (or other location if you have chosen another location during installation)</li></ol><p>You are now ready to do the administration tasks.</p><ol><li><p>Execute the <code>service_stop.bat</code></p></li><li><p>Edit the Service Register script</p></li><li><p>Open <code>service_register.bat</code></p></li><li><p>Edit the line 9 to replace <code>%IP_ADDR%`` by your hostname (or your IP address), the line should look like: </code>set NS_NAME=<a href="mailto:ns_1@couchbase-node1.mycompany.com" target="_blank" rel="noopener noreferrer">ns_1@couchbase-node1.mycompany.com</a>`</p></li><li><p>Save the file3.  Delete the content of: <code>C:\Program Files\Couchbase\Server\var\lib\couchbase\mnesia</code></p></li><li><p>Execute the `service_reregister.bat</p></li></ol><p>This script recreates the Couchbase Server Windows Service and starts it automatically.</p><p><strong>Check the configuration</strong></p><ol><li>Launch your Internet Browser</li><li>Go to http://localhost:8091</li><li>Follow the Couchbase Installation Steps</li><li>Once install connect to the console</li><li>Go to <code>Server Nodes</code> tab</li><li>Check that the server name is now <code>couchbase-node1.mycompany.com</code></li></ol><p><img src="http://3.bp.blogspot.com/-tAn4jv_cdrk/ULzOA53roDI/AAAAAAAAAZ0/r8gts5uSdbU/s320/Screen+Shot+2012-12-03+at+5.06.07+PM.png"></p><p>Your Couchbase node is now configured to use the hostname of your server.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/2012/12/30/couchbase-101-create-views-mapreduce-from-your-java-application"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">¬´ Couchbase 101: Create views (MapReduce) from your Java application</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/2012/12/01/new-adventure-dot-dot-dot"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">New Adventure... ¬ª</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#setting-up-a-hostname-in-hosts-file" class="table-of-contents__link">Setting up a hostname in hosts file</a></li><li><a href="#configure-couchbase-to-use-the-hostname-or-new-ip-address" class="table-of-contents__link">Configure Couchbase to use the hostname or new IP address</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/tgrall" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.linkedin.com/in/tugdualgrall/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.instagram.com/tgrall/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Instagram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/tgrall" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2003 - 2021 Tugdual Grall built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.92eea956.js"></script>
<script src="/assets/js/main.d815768e.js"></script>
</body>
</html>